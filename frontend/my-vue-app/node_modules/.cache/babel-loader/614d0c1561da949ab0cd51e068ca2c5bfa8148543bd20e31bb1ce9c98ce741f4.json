{"ast":null,"code":"import { createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, Fragment as _Fragment, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-60515d0c\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  class: \"card\"\n};\nconst _hoisted_2 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"h2\", null, \"CPU\", -1 /* HOISTED */));\nconst _hoisted_3 = {\n  key: 0\n};\nconst _hoisted_4 = {\n  class: \"card\"\n};\nconst _hoisted_5 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"h2\", null, \"Memory\", -1 /* HOISTED */));\nconst _hoisted_6 = {\n  key: 0\n};\nconst _hoisted_7 = {\n  class: \"card\"\n};\nconst _hoisted_8 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"h2\", null, \"FPS\", -1 /* HOISTED */));\nconst _hoisted_9 = {\n  key: 0\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_apexchart = _resolveComponent(\"apexchart\");\n  return _openBlock(), _createElementBlock(_Fragment, null, [_createCommentVNode(\" <div>\\n        <h1>设备详情</h1>\\n        <p v-if=\\\"deviceData\\\">\\n            <strong>设备名称：</strong> {{ deviceData.device_name }}\\n        </p>\\n        <p v-if=\\\"deviceData\\\">\\n            <strong>其他字段：</strong> {{ deviceData.other_field }}\\n        </p>\\n        <p v-else>\\n            加载中...\\n        </p>\\n    </div> \"), _createElementVNode(\"div\", _hoisted_1, [_hoisted_2, $data.devicePerfInfo ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [_createVNode(_component_apexchart, {\n    type: \"area\",\n    height: \"350\",\n    options: $data.cpuChartOptions,\n    series: $data.cpuSeries\n  }, null, 8 /* PROPS */, [\"options\", \"series\"])])) : _createCommentVNode(\"v-if\", true)]), _createElementVNode(\"div\", _hoisted_4, [_hoisted_5, _ctx.deviceMemInfo ? (_openBlock(), _createElementBlock(\"div\", _hoisted_6, [_createVNode(_component_apexchart, {\n    type: \"area\",\n    height: \"350\",\n    options: $data.memChartOptions,\n    series: $data.memSeries\n  }, null, 8 /* PROPS */, [\"options\", \"series\"])])) : _createCommentVNode(\"v-if\", true)]), _createElementVNode(\"div\", _hoisted_7, [_hoisted_8, _ctx.deviceMemInfo ? (_openBlock(), _createElementBlock(\"div\", _hoisted_9, [_createVNode(_component_apexchart, {\n    type: \"area\",\n    height: \"350\",\n    options: $data.memChartOptions,\n    series: $data.memSeries\n  }, null, 8 /* PROPS */, [\"options\", \"series\"])])) : _createCommentVNode(\"v-if\", true)])], 64 /* STABLE_FRAGMENT */);\n}","map":{"version":3,"names":["class","_createElementVNode","key","_createElementBlock","_Fragment","_createCommentVNode","_hoisted_1","_hoisted_2","$data","devicePerfInfo","_hoisted_3","_createVNode","_component_apexchart","type","height","options","cpuChartOptions","series","cpuSeries","_hoisted_4","_hoisted_5","_ctx","deviceMemInfo","_hoisted_6","memChartOptions","memSeries","_hoisted_7","_hoisted_8","_hoisted_9"],"sources":["/Users/yangcong/性能/Perf/frontend/my-vue-app/src/components/DeviceDetails.vue"],"sourcesContent":["<template>\n    <!-- <div>\n        <h1>设备详情</h1>\n        <p v-if=\"deviceData\">\n            <strong>设备名称：</strong> {{ deviceData.device_name }}\n        </p>\n        <p v-if=\"deviceData\">\n            <strong>其他字段：</strong> {{ deviceData.other_field }}\n        </p>\n        <p v-else>\n            加载中...\n        </p>\n    </div> -->\n    <div class=\"card\">\n        <h2>CPU</h2>\n        <div v-if=\"devicePerfInfo\">\n            <apexchart type=\"area\" height=\"350\" :options=\"cpuChartOptions\" :series=\"cpuSeries\"></apexchart>\n        </div>\n    </div>\n    <div class=\"card\">\n        <h2>Memory</h2>\n        <div v-if=\"deviceMemInfo\">\n            <apexchart type=\"area\" height=\"350\" :options=\"memChartOptions\" :series=\"memSeries\"></apexchart>\n        </div>\n    </div>\n    <div class=\"card\">\n        <h2>FPS</h2>\n        <div v-if=\"deviceMemInfo\">\n            <apexchart type=\"area\" height=\"350\" :options=\"memChartOptions\" :series=\"memSeries\"></apexchart>\n        </div>\n    </div>\n</template>\n\n<script>\nimport axios from 'axios';\nimport VueApexCharts from 'vue3-apexcharts';\n\nexport default {\n    name: 'DeviceDetails',\n    components: {\n        apexchart: VueApexCharts\n    },\n    data() {\n        return {\n            deviceData: null,\n            devicePerfInfo: null,\n            cpuChartOptions: {\n                chart: {\n                    type: 'area',\n                    height: 350,\n                    animations: {\n                        enabled: true,\n                        easing: 'linear',\n                        dynamicAnimation: {\n                            speed: 1000\n                        }\n                    },\n                },\n                xaxis: {\n                    type: 'datetime',\n                    labels: {\n                        datetimeFormatter: {\n                            year: 'yyyy',\n                            month: \"MMM 'yy\",\n                            day: 'dd MMM',\n                            hour: 'HH:mm'\n                        },\n                        style: {\n                            color: '#fff',\n                        }\n\n                    },\n                    title: {\n                        text: '时间',\n                        style: {\n                            color: '#fff'\n                        }\n                    }\n                },\n                tooltip: {\n                    enabled: true,\n                    x: {\n                        format: 'HH:mm:ss'\n                    }\n                },\n                title: {\n                    text: 'CPU',\n                    align: 'left'\n                },\n                stroke: {\n                    width: 2\n                },\n                series: []\n            },\n            memChartOptions: {\n                chart: {\n                    type: 'area',\n                    height: 350,\n                    animations: {\n                        enabled: true,\n                        easing: 'linear',\n                        dynamicAnimation: {\n                            speed: 1000\n                        }\n                    },\n                },\n                xaxis: {\n                    type: 'datetime',\n                    labels: {\n                        datetimeFormatter: {\n                            year: 'yyyy',\n                            month: \"MMM 'yy\",\n                            day: 'dd MMM',\n                            hour: 'HH:mm'\n                        },\n                        style: {\n                            color: '#fff',\n                        }\n                    },\n                    title: {\n                        text: '时间',\n                        style: {\n                            color: '#fff'\n                        }\n                    }\n                },\n                tooltip: {\n                    enabled: true,\n                    x: {\n                        format: 'HH:mm:ss'\n                    }\n                },\n                title: {\n                    text: 'Memory Usage',\n                    align: 'left',\n                    style: {\n                        color: '#fff'\n                    }\n                },\n                stroke: {\n                    width: 2\n                },\n                series: []\n            },\n            cpuSeries: [],\n            memSeries: []\n        };\n    },\n    created() {\n        this.deviceData = {\n            device_name: this.$route.query.device_name,\n            other_field: this.$route.query.other_field\n        };\n\n        this.fetchDevicePerfInfo();\n        this.fetchDeviceMemInfo();\n    },\n    methods: {\n        fetchDevicePerfInfo() {\n            const payload = {\n                device_name: this.deviceData.device_name,\n                other_field: this.deviceData.other_field\n            };\n\n            axios.post('http://127.0.0.1:5000/get_cpu_info', payload)\n                .then(response => {\n                    //console.log(\"API response:\", response.data); \n                    this.devicePerfInfo = response.data;\n                    this.processChartData();\n                    // console.log(this.devicePerfInfo)\n                })\n                .catch(error => {\n                    console.error(\"获取设备性能信息出错:\", error);\n                });\n        },\n        fetchDeviceMemInfo() {\n            const payload = {\n                device_name: this.deviceData.device_name,\n                other_field: this.deviceData.other_field\n            };\n\n            axios.post('http://127.0.0.1:5000/get_mem_info', payload)\n                .then(response => {\n                    this.deviceMemInfo = response.data;\n                    this.processMemChartData();\n                })\n                .catch(error => {\n                    console.error(\"获取设备内存信息出错:\", error);\n                });\n        },\n        processChartData() {\n\n            const cpuSeries = this.devicePerfInfo.map(data => ({\n                x: new Date(data.recorded_at + ' UTC').getTime(), // 加上 ' UTC' 以确保时间戳被解释为UTC时间\n                y: data.device_cpu_rate\n            }));\n\n            const pidCpuSeries = this.devicePerfInfo.map(data => ({\n                x: new Date(data.recorded_at + ' UTC').getTime(),\n                y: data.pid_cpu_rate\n            }));\n\n            const userRateSeries = this.devicePerfInfo.map(data => ({\n                x: new Date(data.recorded_at + ' UTC').getTime(),\n                y: data.user_rate\n            }));\n\n\n            this.cpuSeries = [\n                {\n                    name: 'CPU Rate',\n                    data: cpuSeries\n                },\n                {\n                    name: 'PID CPU Rate',\n                    data: pidCpuSeries\n                },\n                {\n                    name: 'User Rate',\n                    data: userRateSeries\n                }\n            ];\n        },\n        processMemChartData() {\n            const memSeries = this.deviceMemInfo.map(data => ({\n                x: new Date(data.recorded_at + ' UTC').getTime(),\n                y: data.total_ram\n            }));\n\n            const pidMemSeries = this.deviceMemInfo.map(data => ({\n                x: new Date(data.recorded_at + ' UTC').getTime(),\n                y: data.pid_pss\n            }));\n\n            this.memSeries = [\n                {\n                    name: 'Memory Totel',\n                    data: memSeries\n                },\n                {\n                    name: 'Memory Pid Pss',\n                    data: pidMemSeries\n                },\n            ];\n        }\n    }\n};\n</script>\n\n<style scoped>\nh1 {\n    color: #42b983;\n}\n</style>\n"],"mappings":";;;EAaSA,KAAK,EAAC;AAAM;gEACbC,mBAAA,CAAY,YAAR,KAAG;;EAdfC,GAAA;AAAA;;EAmBSF,KAAK,EAAC;AAAM;gEACbC,mBAAA,CAAe,YAAX,QAAM;;EApBlBC,GAAA;AAAA;;EAyBSF,KAAK,EAAC;AAAM;gEACbC,mBAAA,CAAY,YAAR,KAAG;;EA1BfC,GAAA;AAAA;;;uBAAAC,mBAAA,CAAAC,SAAA,SACIC,mBAAA,oUAWU,EACVJ,mBAAA,CAKM,OALNK,UAKM,GAJFC,UAAY,EACDC,KAAA,CAAAC,cAAc,I,cAAzBN,mBAAA,CAEM,OAjBdO,UAAA,GAgBYC,YAAA,CAA+FC,oBAAA;IAApFC,IAAI,EAAC,MAAM;IAACC,MAAM,EAAC,KAAK;IAAEC,OAAO,EAAEP,KAAA,CAAAQ,eAAe;IAAGC,MAAM,EAAET,KAAA,CAAAU;sDAhBpFb,mBAAA,e,GAmBIJ,mBAAA,CAKM,OALNkB,UAKM,GAJFC,UAAe,EACJC,IAAA,CAAAC,aAAa,I,cAAxBnB,mBAAA,CAEM,OAvBdoB,UAAA,GAsBYZ,YAAA,CAA+FC,oBAAA;IAApFC,IAAI,EAAC,MAAM;IAACC,MAAM,EAAC,KAAK;IAAEC,OAAO,EAAEP,KAAA,CAAAgB,eAAe;IAAGP,MAAM,EAAET,KAAA,CAAAiB;sDAtBpFpB,mBAAA,e,GAyBIJ,mBAAA,CAKM,OALNyB,UAKM,GAJFC,UAAY,EACDN,IAAA,CAAAC,aAAa,I,cAAxBnB,mBAAA,CAEM,OA7BdyB,UAAA,GA4BYjB,YAAA,CAA+FC,oBAAA;IAApFC,IAAI,EAAC,MAAM;IAACC,MAAM,EAAC,KAAK;IAAEC,OAAO,EAAEP,KAAA,CAAAgB,eAAe;IAAGP,MAAM,EAAET,KAAA,CAAAiB;sDA5BpFpB,mBAAA,e","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}